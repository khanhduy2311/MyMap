doctype html
html(lang="vi")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css", rel="stylesheet")
    link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css")
    link(rel="stylesheet", href="/css/style-main.css")
    block styles
    title #{pageTitle} | MindTree

  body(class=user ? '' : 'has-fullscreen-bg').d-flex.flex-column.min-vh-100
    //- HEADER CỐ ĐỊNH
    header.bg-dark.text-white.p-3.shadow-sm
      .container
        .d-flex.justify-content-between.align-items-center
          a(href="/", class="h4 text-white text-decoration-none") MINDTREE
          if user
            .dropdown
              button.btn.btn-dark.dropdown-toggle.d-flex.align-items-center(type="button", data-bs-toggle="dropdown")
                img.rounded-circle.me-2(src=user.avatar || '/images/default-avatar.png', alt="avatar", style="width:40px;height:40px;object-fit:cover;border:2px solid #ccc;")
                span #{user.username}
              ul.dropdown-menu.dropdown-menu-end
                li
                  a.dropdown-item(href="/dashboard")
                    i.fas.fa-th-large.me-2
                    | Bảng điều khiển
                li
                  a.dropdown-item(href="/profile")
                    i.fas.fa-user.me-2
                    | Hồ sơ của tôi
                li
                  hr.dropdown-divider
                li
                  a.dropdown-item.text-danger(href="/logout")
                    i.fas.fa-right-from-bracket.me-2
                    | Đăng xuất
          else
            div
              a(href="/login", class="btn btn-outline-light me-2") Đăng nhập
              a(href="/register", class="btn btn-primary") Đăng ký

    //- MAIN CONTENT
    //- Sửa lại: bỏ thẻ main bọc ngoài, để block main tự quyết định layout
    block main
      
    //- FOOTER
    footer.bg-light.text-center.p-3.mt-auto
      .container
        span &copy; 2025 Bản quyền thuộc về Nhóm 3 anh em siu nhân.

    //- SCRIPTS
    block scripts
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js")
    script.
      document.addEventListener('DOMContentLoaded', () => {
        const successAlert = document.querySelector('.alert-success');
        if (successAlert) {
          setTimeout(() => {
            const bsAlert = new bootstrap.Alert(successAlert);
            bsAlert.close();
          }, 2000);
        }
      });